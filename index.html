<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Brand Collective | Portfolio Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
<style>
:root {
    --bg: #0a0a0b; --surface: #141416; --surface-hover: #1a1a1e;
    --border: #232328; --text: #ededed; --text-muted: #8b8b95;
    --primary: #6366f1; --primary-soft: rgba(99,102,241,0.12);
    --green: #22c55e; --green-soft: rgba(34,197,94,0.12);
    --red: #ef4444; --red-soft: rgba(239,68,68,0.12);
    --amber: #f59e0b;
}
.light {
    --bg: #f7f7f8; --surface: #ffffff; --surface-hover: #f0f0f2;
    --border: #e4e4e7; --text: #18181b; --text-muted: #71717a;
    --primary-soft: rgba(99,102,241,0.08);
    --green-soft: rgba(34,197,94,0.08);
    --red-soft: rgba(239,68,68,0.08);
}
* { margin:0; padding:0; box-sizing:border-box; }
body { font-family: -apple-system,BlinkMacSystemFont,'Inter','Segoe UI',Roboto,sans-serif; background:var(--bg); color:var(--text); line-height:1.5; }
.container { max-width:1280px; margin:0 auto; padding:24px 20px; }
header { display:flex; justify-content:space-between; align-items:center; margin-bottom:28px; flex-wrap:wrap; gap:16px; }
.logo { display:flex; align-items:center; gap:14px; }
.logo-mark { width:42px; height:42px; border-radius:10px; background:linear-gradient(135deg,#6366f1,#8b5cf6); display:flex; align-items:center; justify-content:center; font-weight:700; font-size:15px; color:#fff; }
.logo h1 { font-size:20px; font-weight:700; letter-spacing:-0.3px; }
.logo p { font-size:12px; color:var(--text-muted); margin-top:1px; }
.controls { display:flex; gap:8px; align-items:center; }
.pill-group { display:flex; background:var(--surface); border:1px solid var(--border); border-radius:8px; overflow:hidden; }
.pill { padding:7px 14px; font-size:12px; font-weight:500; color:var(--text-muted); cursor:pointer; border:none; background:none; transition:all 0.15s; }
.pill.active { background:var(--primary); color:#fff; }
.pill:hover:not(.active) { color:var(--text); background:var(--surface-hover); }
.theme-toggle { padding:7px 12px; border-radius:8px; border:1px solid var(--border); background:var(--surface); color:var(--text-muted); cursor:pointer; font-size:13px; }
.grid { display:grid; gap:16px; margin-bottom:16px; }
.grid-4 { grid-template-columns: repeat(4, 1fr); }
.grid-2 { grid-template-columns: repeat(2, 1fr); }
.grid-perf { grid-template-columns: repeat(2, 1fr); }
@media(max-width:900px) { .grid-4 { grid-template-columns: repeat(2,1fr); } }
@media(max-width:600px) { .grid-4,.grid-2,.grid-perf { grid-template-columns:1fr; } }
.card { background:var(--surface); border:1px solid var(--border); border-radius:12px; padding:20px; }
.kpi-label { font-size:11px; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; color:var(--text-muted); margin-bottom:6px; }
.kpi-value { font-size:32px; font-weight:700; letter-spacing:-1px; line-height:1.1; }
.kpi-sub { display:flex; gap:12px; margin-top:8px; font-size:12px; color:var(--text-muted); align-items:center; }
.badge { display:inline-flex; align-items:center; gap:3px; padding:2px 8px; border-radius:6px; font-weight:600; font-size:11px; }
.badge.up { background:var(--green-soft); color:var(--green); }
.badge.down { background:var(--red-soft); color:var(--red); }
.card-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:16px; }
.card-title { font-size:15px; font-weight:600; }
.chart-wrap { position:relative; height:280px; }
table { width:100%; border-collapse:collapse; font-size:13px; }
th { text-align:left; font-size:11px; font-weight:600; text-transform:uppercase; letter-spacing:0.5px; color:var(--text-muted); padding:10px 12px; border-bottom:1px solid var(--border); cursor:pointer; user-select:none; white-space:nowrap; }
th:hover { color:var(--text); }
td { padding:10px 12px; border-bottom:1px solid var(--border); white-space:nowrap; }
tr:hover { background:var(--surface-hover); }
.rank { display:inline-flex; align-items:center; justify-content:center; width:24px; height:24px; border-radius:6px; font-size:11px; font-weight:700; }
.rank.gold { background:linear-gradient(135deg,#f59e0b,#d97706); color:#fff; }
.rank.silver { background:linear-gradient(135deg,#94a3b8,#64748b); color:#fff; }
.rank.bronze { background:linear-gradient(135deg,#d97706,#a16207); color:#fff; }
.rank.normal { background:var(--surface-hover); color:var(--text-muted); }
.perf-item { display:flex; align-items:center; gap:12px; padding:12px; border-radius:8px; background:var(--bg); margin-bottom:8px; }
.perf-rank { font-size:18px; font-weight:800; color:var(--primary); min-width:28px; }
.perf-rank.bottom { color:var(--red); }
.perf-info { flex:1; }
.perf-name { font-weight:600; font-size:14px; }
.perf-detail { font-size:12px; color:var(--text-muted); }
.search-box { padding:8px 14px; border-radius:8px; border:1px solid var(--border); background:var(--bg); color:var(--text); font-size:13px; width:200px; }
.search-box::placeholder { color:var(--text-muted); }
.footer { text-align:center; padding:24px 0 8px; font-size:11px; color:var(--text-muted); }
.port-label { font-size:11px; padding:3px 10px; border-radius:20px; background:var(--primary-soft); color:var(--primary); font-weight:600; }
.donut-wrap { display:flex; align-items:center; justify-content:center; gap:32px; flex-wrap:wrap; }
.donut-chart { width:220px; height:220px; }
.donut-legend { display:flex; flex-direction:column; gap:12px; }
.legend-item { display:flex; align-items:center; gap:10px; font-size:13px; }
.legend-dot { width:12px; height:12px; border-radius:3px; }
.legend-value { font-weight:600; margin-left:auto; }
.sort-arrow { font-size:10px; margin-left:3px; }
</style>
</head>
<body>
<div class="container">
<header>
<div class="logo">
<div class="logo-mark">BC</div>
<div><h1>Brand Collective</h1><p>Portfolio Ecommerce Dashboard</p></div>
</div>
<div class="controls">
<div class="pill-group" id="periodPills">
<button class="pill" data-period="yesterday">Yesterday</button>
<button class="pill" data-period="week">7 Days</button>
<button class="pill active" data-period="month">30 Days</button>
</div>
<button class="theme-toggle" onclick="toggleTheme()">â˜€ Light</button>
</div>
</header>

<div class="grid grid-4" id="kpiGrid">
<div class="card"><div class="kpi-label">Demand Sales</div><div class="kpi-value" id="kpiSales"></div><div class="kpi-sub"><span id="kpiSalesSub"></span><span class="badge" id="kpiSalesYoy"></span></div></div>
<div class="card"><div class="kpi-label">Total Orders</div><div class="kpi-value" id="kpiOrders"></div><div class="kpi-sub"><span id="kpiOrdersSub"></span><span class="badge" id="kpiOrdersYoy"></span></div></div>
<div class="card"><div class="kpi-label">Avg Order Value</div><div class="kpi-value" id="kpiAov"></div><div class="kpi-sub"><span id="kpiAovSub"></span></div></div>
<div class="card"><div class="kpi-label">Avg Daily Sales</div><div class="kpi-value" id="kpiAvgDaily"></div><div class="kpi-sub"><span id="kpiAvgDailySub"></span></div></div>
</div>

<div class="grid grid-2">
<div class="card"><div class="card-header"><span class="card-title">Daily Demand Sales</span><span class="port-label">Last 30 Days</span></div><div class="chart-wrap"><canvas id="trendChart"></canvas></div></div>
<div class="card"><div class="card-header"><span class="card-title">Portfolio Breakdown</span><span class="port-label">By Demand Sales</span></div><div class="donut-wrap"><div class="donut-chart"><canvas id="portfolioChart"></canvas></div><div class="donut-legend" id="portfolioLegend"></div></div></div>
</div>

<div class="grid grid-perf" style="margin-top:0">
<div class="card"><div class="card-header"><span class="card-title">ðŸ”¥ Top Performers</span><span class="port-label">30-Day Demand Sales</span></div><div id="topPerformers"></div></div>
<div class="card"><div class="card-header"><span class="card-title">ðŸ“‰ Needs Attention</span><span class="port-label">30-Day Demand Sales</span></div><div id="bottomPerformers"></div></div>
</div>

<div class="card" style="margin-top:16px">
<div class="card-header"><span class="card-title">Brand Leaderboard</span><div style="display:flex;gap:8px;align-items:center"><input class="search-box" placeholder="Search brands..." id="brandSearch" oninput="filterBrands()"><span class="port-label" id="brandCount"></span></div></div>
<div style="overflow-x:auto"><table><thead><tr>
<th onclick="sortTable(0)">#</th>
<th onclick="sortTable(1)">Brand</th>
<th onclick="sortTable(2)">Demand Sales <span class="sort-arrow" id="sort2">â–¼</span></th>
<th onclick="sortTable(3)">Orders</th>
<th onclick="sortTable(4)">AOV</th>
<th onclick="sortTable(5)">Portfolio</th>
</tr></thead><tbody id="brandTable"></tbody></table></div>
</div>

<div class="footer">Data as of Thursday, 12 February 2026 at 7:32 am AEST Â· Powered by Polar Analytics Â· Built by The Claw ðŸ¦€</div>
</div>

<script>
const DATA = {"kpis": {"yesterday": {"demand_sales": 216981, "orders": 1629, "aov": 133}, "week": {"demand_sales": 1718691, "orders": 13717, "aov": 125}, "month": {"demand_sales": 7679655, "orders": 58519, "aov": 131}, "yoy": {"sales_pct": 25.4, "orders_pct": 22.7}}, "trend": {"labels": ["2026-01-13", "2026-01-14", "2026-01-15", "2026-01-16", "2026-01-17", "2026-01-18", "2026-01-19", "2026-01-20", "2026-01-21", "2026-01-22", "2026-01-23", "2026-01-24", "2026-01-25", "2026-01-26", "2026-01-27", "2026-01-28", "2026-01-29", "2026-01-30", "2026-01-31", "2026-02-01", "2026-02-02", "2026-02-03", "2026-02-04", "2026-02-05", "2026-02-06", "2026-02-07", "2026-02-08", "2026-02-09", "2026-02-10", "2026-02-11"], "values": [262801, 271552, 275831, 253246, 241738, 311760, 293932, 290551, 290762, 303702, 265256, 249498, 255991, 288110, 249338, 252318, 263091, 209143, 237433, 275284, 223684, 196677, 199266, 230516, 200271, 244419, 406227, 219597, 200681, 216981], "orders": [2011, 2068, 2056, 1888, 1831, 2212, 2212, 2181, 2168, 2306, 1961, 1884, 1870, 2141, 1946, 1903, 1942, 1641, 1751, 2002, 1744, 1546, 1538, 1786, 1566, 1864, 3540, 1779, 1553, 1629]}, "brands": [{"rank": 1, "name": "Shoes & Sox", "demand_sales": 1914483, "orders": 16981, "aov": 113, "portfolio": "Footwear", "yesterday_sales": 33256, "yesterday_orders": 351, "week_sales": 233477, "week_orders": 2405}, {"rank": 2, "name": "Reebok", "demand_sales": 790754, "orders": 5785, "aov": 137, "portfolio": "Licenced", "yesterday_sales": 30416, "yesterday_orders": 213, "week_sales": 182239, "week_orders": 1271}, {"rank": 3, "name": "Black Pepper", "demand_sales": 780899, "orders": 5924, "aov": 132, "portfolio": "Apparel", "yesterday_sales": 25845, "yesterday_orders": 182, "week_sales": 154540, "week_orders": 1133}, {"rank": 4, "name": "Hush Puppies", "demand_sales": 730390, "orders": 4970, "aov": 147, "portfolio": "Footwear", "yesterday_sales": 26390, "yesterday_orders": 177, "week_sales": 182404, "week_orders": 1228}, {"rank": 5, "name": "Superdry", "demand_sales": 697345, "orders": 5518, "aov": 126, "portfolio": "Licenced", "yesterday_sales": 25636, "yesterday_orders": 209, "week_sales": 348744, "week_orders": 3043}, {"rank": 6, "name": "Review", "demand_sales": 653192, "orders": 3240, "aov": 202, "portfolio": "Apparel", "yesterday_sales": 20070, "yesterday_orders": 82, "week_sales": 149139, "week_orders": 710}, {"rank": 7, "name": "Clarks", "demand_sales": 509438, "orders": 4173, "aov": 122, "portfolio": "Footwear", "yesterday_sales": 8398, "yesterday_orders": 81, "week_sales": 84532, "week_orders": 721}, {"rank": 8, "name": "Shoe Warehouse", "demand_sales": 503025, "orders": 5113, "aov": 98, "portfolio": "Footwear", "yesterday_sales": 15018, "yesterday_orders": 145, "week_sales": 157544, "week_orders": 1758}, {"rank": 9, "name": "Elka Collective", "demand_sales": 338111, "orders": 1326, "aov": 255, "portfolio": "Apparel", "yesterday_sales": 9780, "yesterday_orders": 32, "week_sales": 58298, "week_orders": 244}, {"rank": 10, "name": "Yarra Trail", "demand_sales": 153903, "orders": 1107, "aov": 139, "portfolio": "Apparel", "yesterday_sales": 6641, "yesterday_orders": 35, "week_sales": 29100, "week_orders": 173}, {"rank": 11, "name": "Volley", "demand_sales": 117771, "orders": 1044, "aov": 113, "portfolio": "Design Works", "yesterday_sales": 3867, "yesterday_orders": 34, "week_sales": 35796, "week_orders": 289}, {"rank": 12, "name": "Champion", "demand_sales": 105322, "orders": 1030, "aov": 102, "portfolio": "Licenced", "yesterday_sales": 2676, "yesterday_orders": 26, "week_sales": 22336, "week_orders": 205}, {"rank": 13, "name": "Canada Goose", "demand_sales": 92218, "orders": 58, "aov": 1590, "portfolio": "Licenced", "yesterday_sales": 2300, "yesterday_orders": 1, "week_sales": 16527, "week_orders": 11}, {"rank": 14, "name": "Everlast", "demand_sales": 71724, "orders": 483, "aov": 148, "portfolio": "Design Works", "yesterday_sales": 2526, "yesterday_orders": 24, "week_sales": 18191, "week_orders": 169}, {"rank": 15, "name": "Julius Marlow", "demand_sales": 67723, "orders": 395, "aov": 171, "portfolio": "Footwear", "yesterday_sales": 1903, "yesterday_orders": 13, "week_sales": 15167, "week_orders": 94}, {"rank": 16, "name": "Marco Polo", "demand_sales": 50382, "orders": 428, "aov": 118, "portfolio": "Apparel", "yesterday_sales": 810, "yesterday_orders": 8, "week_sales": 10987, "week_orders": 97}, {"rank": 17, "name": "Harrison", "demand_sales": 38961, "orders": 321, "aov": 121, "portfolio": "Footwear", "yesterday_sales": 82, "yesterday_orders": 1, "week_sales": 3128, "week_orders": 26}, {"rank": 18, "name": "Happy Socks", "demand_sales": 27790, "orders": 336, "aov": 83, "portfolio": "Licenced", "yesterday_sales": 645, "yesterday_orders": 9, "week_sales": 7124, "week_orders": 77}, {"rank": 19, "name": "Umbro", "demand_sales": 26201, "orders": 230, "aov": 114, "portfolio": "Design Works", "yesterday_sales": 575, "yesterday_orders": 5, "week_sales": 7510, "week_orders": 53}, {"rank": 20, "name": "Replay", "demand_sales": 10024, "orders": 57, "aov": 176, "portfolio": "Licenced", "yesterday_sales": 145, "yesterday_orders": 1, "week_sales": 1908, "week_orders": 10}], "portfolio": [{"name": "Footwear", "value": 3764019}, {"name": "Apparel", "value": 1976487}, {"name": "Licenced", "value": 1723453}, {"name": "Design Works", "value": 215695}]};

const fmt = (n) => {
    if(n >= 1000000) return '$' + (n/1000000).toFixed(1) + 'M';
    if(n >= 1000) return '$' + (n/1000).toFixed(0) + 'K';
    return '$' + n.toLocaleString();
};
const fmtFull = (n) => '$' + Math.round(n).toLocaleString();
const fmtNum = (n) => n.toLocaleString();

function updateKPIs(period) {
    const d = DATA.kpis[period];
    const days = period === 'yesterday' ? 1 : period === 'week' ? 7 : 30;
    document.getElementById('kpiSales').textContent = fmt(d.demand_sales);
    document.getElementById('kpiOrders').textContent = fmtNum(d.orders);
    document.getElementById('kpiAov').textContent = '$' + d.aov;
    document.getElementById('kpiAvgDaily').textContent = fmt(Math.round(d.demand_sales / days));
    
    if(period === 'month') {
        const yoy = DATA.kpis.yoy;
        document.getElementById('kpiSalesSub').textContent = '30d: ' + fmtFull(d.demand_sales);
        document.getElementById('kpiSalesYoy').textContent = (yoy.sales_pct >= 0 ? 'â†‘' : 'â†“') + ' ' + Math.abs(yoy.sales_pct) + '% YoY';
        document.getElementById('kpiSalesYoy').className = 'badge ' + (yoy.sales_pct >= 0 ? 'up' : 'down');
        document.getElementById('kpiOrdersSub').textContent = '30d: ' + fmtNum(d.orders);
        document.getElementById('kpiOrdersYoy').textContent = (yoy.orders_pct >= 0 ? 'â†‘' : 'â†“') + ' ' + Math.abs(yoy.orders_pct) + '% YoY';
        document.getElementById('kpiOrdersYoy').className = 'badge ' + (yoy.orders_pct >= 0 ? 'up' : 'down');
    } else {
        document.getElementById('kpiSalesSub').textContent = days + 'd: ' + fmtFull(d.demand_sales);
        document.getElementById('kpiSalesYoy').textContent = '';
        document.getElementById('kpiSalesYoy').className = '';
        document.getElementById('kpiOrdersSub').textContent = days + 'd: ' + fmtNum(d.orders);
        document.getElementById('kpiOrdersYoy').textContent = '';
        document.getElementById('kpiOrdersYoy').className = '';
    }
    document.getElementById('kpiAovSub').textContent = days + 'd average';
    document.getElementById('kpiAvgDailySub').textContent = 'per day (' + days + 'd)';
}

// Period pills
document.querySelectorAll('#periodPills .pill').forEach(btn => {
    btn.addEventListener('click', () => {
        document.querySelectorAll('#periodPills .pill').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        updateKPIs(btn.dataset.period);
    });
});

// Theme
function toggleTheme() {
    document.body.classList.toggle('light');
    const isLight = document.body.classList.contains('light');
    document.querySelector('.theme-toggle').textContent = isLight ? 'ðŸŒ™ Dark' : 'â˜€ Light';
    if(window.trendChart) { updateChartTheme(); }
}

// Trend chart
const labels = ["13 Jan", "14 Jan", "15 Jan", "16 Jan", "17 Jan", "18 Jan", "19 Jan", "20 Jan", "21 Jan", "22 Jan", "23 Jan", "24 Jan", "25 Jan", "26 Jan", "27 Jan", "28 Jan", "29 Jan", "30 Jan", "31 Jan", "1 Feb", "2 Feb", "3 Feb", "4 Feb", "5 Feb", "6 Feb", "7 Feb", "8 Feb", "9 Feb", "10 Feb", "11 Feb"];
const values = DATA.trend.values;
let trendChart;

function createTrendChart() {
    const ctx = document.getElementById('trendChart').getContext('2d');
    const gradient = ctx.createLinearGradient(0, 0, 0, 280);
    gradient.addColorStop(0, 'rgba(99,102,241,0.25)');
    gradient.addColorStop(1, 'rgba(99,102,241,0)');
    trendChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [{
                data: values,
                borderColor: '#6366f1',
                backgroundColor: gradient,
                fill: true,
                tension: 0.35,
                pointRadius: 0,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: '#6366f1',
                borderWidth: 2.5,
            }]
        },
        options: {
            responsive: true, maintainAspectRatio: false,
            plugins: {
                legend: { display: false },
                tooltip: {
                    backgroundColor: 'rgba(20,20,22,0.95)',
                    titleColor: '#ededed', bodyColor: '#ededed',
                    padding: 12, cornerRadius: 8,
                    callbacks: { label: (c) => fmtFull(c.raw) }
                }
            },
            scales: {
                x: { grid: { display: false }, ticks: { color: '#8b8b95', font: { size: 11 }, maxRotation: 0, autoSkip: true, maxTicksLimit: 8 } },
                y: { grid: { color: 'rgba(139,139,149,0.1)' }, ticks: { color: '#8b8b95', font: { size: 11 }, callback: (v) => fmt(v) } }
            },
            interaction: { intersect: false, mode: 'index' }
        }
    });
}

function updateChartTheme() {
    const muted = document.body.classList.contains('light') ? '#71717a' : '#8b8b95';
    const gridC = document.body.classList.contains('light') ? 'rgba(113,113,122,0.1)' : 'rgba(139,139,149,0.1)';
    trendChart.options.scales.x.ticks.color = muted;
    trendChart.options.scales.y.ticks.color = muted;
    trendChart.options.scales.y.grid.color = gridC;
    trendChart.update();
    if(window.portChart) {
        portChart.update();
    }
}

// Portfolio donut
const portColors = ['#6366f1', '#22c55e', '#f59e0b', '#ef4444'];
let portChart;
function createPortfolioChart() {
    const ctx = document.getElementById('portfolioChart').getContext('2d');
    portChart = new Chart(ctx, {
        type: 'doughnut',
        data: {
            labels: DATA.portfolio.map(p => p.name),
            datasets: [{
                data: DATA.portfolio.map(p => p.value),
                backgroundColor: portColors,
                borderWidth: 0,
                hoverOffset: 6,
            }]
        },
        options: {
            responsive: true, maintainAspectRatio: true,
            cutout: '68%',
            plugins: {
                legend: { display: false },
                tooltip: {
                    callbacks: {
                        label: (c) => c.label + ': ' + fmtFull(c.raw) + ' (' + ((c.raw / DATA.portfolio.reduce((a,b)=>a+b.value,0)) * 100).toFixed(1) + '%)'
                    }
                }
            }
        }
    });
    // Legend
    const legend = document.getElementById('portfolioLegend');
    const total = DATA.portfolio.reduce((a,b) => a + b.value, 0);
    DATA.portfolio.forEach((p, i) => {
        const pct = ((p.value / total) * 100).toFixed(1);
        legend.innerHTML += '<div class="legend-item"><span class="legend-dot" style="background:'+portColors[i]+'"></span><span>'+p.name+'</span><span class="legend-value">'+fmt(p.value)+' ('+pct+'%)</span></div>';
    });
}

// Top/Bottom performers
function renderPerformers() {
    const brands = DATA.brands;
    const top = brands.slice(0, 3);
    const bottom = brands.slice(-3).reverse();
    
    let topHtml = '';
    top.forEach((b, i) => {
        topHtml += '<div class="perf-item"><div class="perf-rank">'+(i+1)+'</div><div class="perf-info"><div class="perf-name">'+b.name+'</div><div class="perf-detail">'+fmtFull(b.demand_sales)+' Â· '+fmtNum(b.orders)+' orders</div></div></div>';
    });
    document.getElementById('topPerformers').innerHTML = topHtml;
    
    let bottomHtml = '';
    bottom.forEach((b) => {
        bottomHtml += '<div class="perf-item"><div class="perf-rank bottom">'+b.rank+'</div><div class="perf-info"><div class="perf-name">'+b.name+'</div><div class="perf-detail">'+fmtFull(b.demand_sales)+' Â· '+fmtNum(b.orders)+' orders</div></div></div>';
    });
    document.getElementById('bottomPerformers').innerHTML = bottomHtml;
}

// Brand leaderboard
let sortCol = 2, sortDir = -1;
function renderBrandTable(filter) {
    const tbody = document.getElementById('brandTable');
    let brands = [...DATA.brands];
    if(filter) brands = brands.filter(b => b.name.toLowerCase().includes(filter.toLowerCase()));
    
    brands.sort((a, b) => {
        const keys = ['rank','name','demand_sales','orders','aov','portfolio'];
        const k = keys[sortCol];
        if(typeof a[k] === 'string') return sortDir * a[k].localeCompare(b[k]);
        return sortDir * (a[k] - b[k]);
    });
    
    let html = '';
    brands.forEach((b, i) => {
        const rankClass = b.rank === 1 ? 'gold' : b.rank === 2 ? 'silver' : b.rank === 3 ? 'bronze' : 'normal';
        html += '<tr><td><span class="rank '+rankClass+'">'+b.rank+'</span></td><td style="font-weight:600">'+b.name+'</td><td>'+fmtFull(b.demand_sales)+'</td><td>'+fmtNum(b.orders)+'</td><td>$'+b.aov+'</td><td><span class="port-label" style="font-size:10px">'+b.portfolio+'</span></td></tr>';
    });
    tbody.innerHTML = html;
    document.getElementById('brandCount').textContent = brands.length + ' brands';
}

function sortTable(col) {
    if(sortCol === col) sortDir *= -1;
    else { sortCol = col; sortDir = col === 1 || col === 5 ? 1 : -1; }
    document.querySelectorAll('.sort-arrow').forEach(el => el.textContent = '');
    const arrow = document.getElementById('sort' + col);
    if(arrow) arrow.textContent = sortDir === -1 ? 'â–¼' : 'â–²';
    renderBrandTable(document.getElementById('brandSearch').value);
}

function filterBrands() {
    renderBrandTable(document.getElementById('brandSearch').value);
}

// Init
updateKPIs('month');
createTrendChart();
createPortfolioChart();
renderPerformers();
renderBrandTable();
</script>
</body>
</html>